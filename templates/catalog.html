{% extends 'base.html' %}
{% load static %}

{% block content %}
<main>
  <h3 data-translate-key="catalog.what_is_dual">‚ÑπÔ∏è Qu√® √©s Audiovook Dual?</h3>
  <p data-translate-key="catalog.what_is_dual_text">
    Audiovook Dual √©s una col¬∑lecci√≥ d‚Äôaudiorelats biling√ºes que et permet escoltar una mateixa hist√≤ria en dues lleng√ºes. √âs una forma d‚Äôaprendre jugant amb el so, la repetici√≥ i el context.
  </p>
  <h2 style="text-align:center" data-translate-key="catalog.available_stories">üìö Relats disponibles</h2>

  <!-- Barra de filtres -->
  <form method="get" action="{% url 'products:catalog' %}" id="filtersBar">
    <div class="av-input">
      <input type="text" name="q" placeholder="üîç Cerca per text o t√≠tol..." data-translate-key="catalog.search_placeholder" value="{{ request.GET.q }}">
    </div>
    <div class="av-select" data-placeholder="Col¬∑lecci√≥">
      <label data-translate-key="catalog.filter.collection">Col¬∑lecci√≥</label>
      <select name="collection" onchange="this.form.submit()">
        <option value="">--</option>
        {% for collection in collections %}
        <option value="{{ collection }}" {% if request.GET.collection == collection %}selected{% endif %}>{{ collection }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="av-select" data-placeholder="Nivell">
      <label data-translate-key="catalog.filter.level">Nivell</label>
      <select name="level" onchange="this.form.submit()">
        <option value="">--</option>
        {% for level in levels %}
        <option value="{{ level }}" {% if request.GET.level == level %}selected{% endif %}>{{ level }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="av-select" data-placeholder="Durada">
      <label data-translate-key="catalog.filter.duration">Durada</label>
      <select name="duration" onchange="this.form.submit()">
        <option value="">--</option>
        {% for duration in durations %}
        <option value="{{ duration }}" {% if request.GET.duration == duration %}selected{% endif %}>{{ duration }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="av-select" data-placeholder="Lleng√ºes">
      <label data-translate-key="catalog.filter.languages">Lleng√ºes</label>
      <select name="lang" onchange="this.form.submit()">
        <option value="">--</option>
        {% for lang in languages %}
        <option value="{{ lang }}" {% if request.GET.lang == lang %}selected{% endif %}>{{ lang }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="av-select" data-placeholder="Edats">
      <label data-translate-key="catalog.filter.ages">Edats</label>
      <select name="ages" onchange="this.form.submit()">
        <option value="">--</option>
        {% for ages in ages_list %}
        <option value="{{ ages }}" {% if request.GET.ages == ages %}selected{% endif %}>{{ ages }}</option>
        {% endfor %}
      </select>
    </div>
    <button type="submit" data-translate-key="catalog.filter.button">Filtra</button>
  </form>

  <!-- Missatge inicial -->
  <div id="helpNote">
    <h3 style="text-align:center" data-translate-key="catalog.dual_in_3_clicks">Dual en 3 clics:</h3>
    <p>1Ô∏è‚É£ <span data-translate-key="catalog.click1">Selecciona quin tipus de textos vols</span><br>
      2Ô∏è‚É£ <span data-translate-key="catalog.click2">Tria un relat</span><br>
      3Ô∏è‚É£ <span data-translate-key="catalog.click3">Anir√†s al reproductor i podr√†s experimentar el sistema Dual</span></p>
  </div>

  <section id="catalog">
    {% for item in titles_with_status %}
    <div class="titleCard">
      <img src="{{ item.image_url }}" alt="{{ item.title.human_name }}" class="title-image" />
      <div class="meta-top">
        {% if item.title.levels %}<span class="level">{{ item.title.levels }}</span>{% endif %}
        {% if item.title.ages %}<span class="ages">{{ item.title.ages }}</span>{% endif %}
      </div>
      <div class="cardText">
        <h3 class="title-container">
          {{ item.title.human_name }}
          <a href="{% url 'products:player' machine_name=item.title.machine_name %}" class="play-button">
            <img src="{% static 'imgs/Boto-Play.png' %}" alt="Play" />
          </a>
        </h3>
        <div class="meta">
          {% if item.title.collection %}<span class="collection">{{ item.title.collection }}</span>{% endif %}
          {% if item.title.duration %}<span class="duration">{{ item.title.duration }}</span>{% endif %}
        </div>
        {% if item.title.languages.all %}
        <div class="langList">
          {% for lang in item.title.languages.all %}
            {{ lang.language }}{% if not forloop.last %}, {% endif %}
          {% endfor %}
        </div>
        {% endif %}
        {% if item.title.description %}
        <div class="description">{{ item.title.description }}</div>
        {% endif %}
      </div>
      <div class="status-label">
        {% if item.status == 'FREE' %}
          <span class="free" data-translate-key="card.free">FREE</span>
        {% elif item.status == 'PREMIUM_OWNED' %}
          <span class="premium-owned" data-translate-key="card.premium">PREMIUM</span>
        {% elif item.status == 'PREMIUM_NOT_OWNED' %}
          <span class="premium-not-owned" data-translate-key="card.premium">PREMIUM</span>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </section>
  <div id="helpIcon">‚ùî</div>
</main>
{% endblock %}
