{% extends 'base.html' %}
{% load static %}

{% block title %}Audiovook Dual — Històries en dues llengües{% endblock %}

{% block content %}
<section class="hero">
    <div class="hero__text">
        <p class="hero__kicker">Dual Understanding And Listening</p>
        <h1>{{ marketing_title }}</h1>
        <p class="hero__subtitle">{{ marketing_subtitle }}</p>
        <div class="hero__actions">
            <a class="button" href="#productes">Descobreix els productes</a>
            <a class="button button--ghost" href="{% url 'signup' %}">Crea un compte</a>
        </div>
    </div>
    <div class="hero__art">
        <img src="{% static 'imgs/mockup_portada.png' %}" alt="Mockup Audiovook" />
    </div>
</section>

<section class="features" id="productes">
    <div class="section__header">
        <p class="kicker">Productes</p>
        <h2>Històries curtes per practicar llengües</h2>
        <p>Consulta el catàleg d'audiollibres bilingües. Entra a un producte per veure la descripció i reproduir l'àudio.</p>
        {% if user.is_authenticated %}
            <a class="button button--small" href="{% url 'products:create' %}">Afegir un nou producte</a>
        {% endif %}
    </div>
    <div class="product-grid">
<<<<<<< ours
        {% for package in packages %}
            {% with product=package.product titles=package.titles %}
=======
        {% for product in products %}
            {% with titles=product.titles.all %}
>>>>>>> theirs
                <article class="product-card">
                    {% if product.cover_image %}
                        <img src="{% if product.cover_image|slice:':1' == '/' %}{{ product.cover_image }}{% else %}{% static product.cover_image %}{% endif %}" alt="{{ product.title }}" class="product-card__image" />
                    {% else %}
                        <img src="{% static 'imgs/logo.png' %}" alt="{{ product.title }}" class="product-card__image" />
                    {% endif %}
                    <div class="product-card__body">
                        <p class="product-card__eyebrow">{{ product.language_pair }}</p>
                        <h3>{{ product.title }}</h3>
                        <p class="product-card__description">{{ product.description|truncatewords:30 }}</p>
                        <p class="product-card__meta">Nivell del paquet: {{ product.level|default:'No definit' }}</p>
                        {% if titles %}
                            <div class="product-card__titles">
                                <p class="kicker">Títols inclosos</p>
                                <ul>
                                    {% for title in titles %}
                                        <li>
<<<<<<< ours
                                            <span class="product-card__title-name">{{ title.title }}</span>
                                            {% if title.langs %}<span class="product-card__badge">{{ title.langs|join:', ' }}</span>{% endif %}
=======
                                            <span class="product-card__title-name">{{ title.title_human }}</span>
                                            {% if title.language_list %}<span class="product-card__badge">{{ title.language_list|join:', ' }}</span>{% endif %}
>>>>>>> theirs
                                            {% if title.duration %}<span class="product-card__badge product-card__badge--muted">{{ title.duration }}</span>{% endif %}
                                        </li>
                                    {% endfor %}
                                </ul>
                            </div>
                        {% else %}
                            <p class="product-card__meta">Cap títol assignat a aquest paquet.</p>
                        {% endif %}
                        <div class="product-card__footer">
                            <span class="product-card__price">{{ product.price }} €</span>
                            <a class="button button--small" href="{% url 'products:detail' product.pk %}">Veure fitxa</a>
                        </div>
                    </div>
                </article>
            {% endwith %}
        {% empty %}
            <p>Encara no hi ha productes. Si tens permís, crea'n un!</p>
        {% endfor %}
    </div>
</section>

<section class="cta">
    <div class="cta__text">
        <h2>Entra a Audiovook Dual</h2>
        <p>Registra't per gestionar productes, pujar arxius d'àudio i crear una experiència d'aprenentatge immersiva.</p>
    </div>
    <div class="cta__actions">
        {% if user.is_authenticated %}
            <a class="button" href="{% url 'products:create' %}">Crea un producte</a>
        {% else %}
            <a class="button" href="{% url 'signup' %}">Comença ara</a>
            <a class="button button--ghost" href="{% url 'login' %}">Ja tinc compte</a>
        {% endif %}
    </div>
</section>
{% endblock %}
