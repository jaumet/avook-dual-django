{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
    <h1 data-translate-key="library.my_library">La meva llibreria</h1>
    <hr>
    {% for package in packages %}
    <div class="accordion">
        <div class="accordion-header">
            <h4 class="package-title">{{ package.name }}</h4>
            <span class="accordion-icon">+</span>
        </div>
        <div class="accordion-content">
            <section class="catalog-grid">
                {% for item in package.titles_with_status %}
                <div class="titleCard">
                  <img src="{{ item.image_url }}" alt="{{ item.title.human_name }}" class="title-image" />
                  <div class="meta-top">
                    {% if item.title.levels %}<span class="level">{{ item.title.levels }}</span>{% endif %}
                    {% if item.title.ages %}<span class="ages">{{ item.title.ages }}</span>{% endif %}
                  </div>
                  <div class="cardText">
                    <h3 class="title-container">
                      {{ item.title.human_name }}
                      <a href="{% url 'products:player' machine_name=item.title.machine_name %}" class="play-button">
                        <img src="{% static 'imgs/Boto-Play.png' %}" alt="Play" />
                      </a>
                    </h3>
                    <div class="meta">
                      {% if item.title.collection %}<span class="collection">{{ item.title.collection }}</span>{% endif %}
                      {% if item.title.duration %}<span class="duration">{{ item.title.duration }}</span>{% endif %}
                    </div>
                    {% if item.title.languages.all %}
                    <div class="langList">
                      {% for lang in item.title.languages.all %}
                        {{ lang.language }}{% if not forloop.last %}, {% endif %}
                      {% endfor %}
                    </div>
                    {% endif %}
                    {% if item.title.description %}
                    <div class="description">{{ item.title.description }}</div>
                    {% endif %}
                  </div>
                  <div class="status-label">
                    {% if item.status == 'FREE' %}
                      <span class="free" data-translate-key="card.free">GRATUÏT</span>
                    {% elif item.status == 'PREMIUM_OWNED' %}
                      <span class="premium-owned" data-translate-key="card.premium">PREMIUM</span>
                    {% endif %}
                  </div>
                </div>
                {% empty %}
                <p data-translate-key="home.no_titles_in_package">No hi ha títols en aquest paquet.</p>
                {% endfor %}
            </section>
        </div>
    </div>
    {% empty %}
    <p data-translate-key="library.no_packages">No tens accés a cap paquet.</p>
    {% endfor %}
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/accordion.js' %}"></script>
{% endblock %}
