{% load static %}
<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Audiovook Dual{% endblock %}</title>
    <link rel="stylesheet" href="{% static 'css/index.css' %}">
    <link rel="stylesheet" href="{% static 'css/forms.css' %}">
    {% block extra_css %}{% endblock %}
</head>
<body class="dark">
    <script src="{% static 'js/main.js' %}"></script>
    <script src="{% static 'js/translator.js' %}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const langSelect = document.getElementById('language-select');
            const currentLang = window.location.pathname.split('/')[1] || 'ca';

            // Set the dropdown to the current language
            langSelect.value = currentLang;

            langSelect.addEventListener('change', (event) => {
                const newLang = event.target.value;
                const pathParts = window.location.pathname.split('/');

                // Replace the language part of the URL, or add it if it's not there
                if (pathParts.length > 1 && ['ca', 'en', 'es', 'fr', 'it', 'pt'].includes(pathParts[1])) {
                    pathParts[1] = newLang;
                } else {
                    pathParts.splice(1, 0, newLang);
                }

                window.location.pathname = pathParts.join('/');
            });
        });
    </script>
    {% block extra_js %}{% endblock %}
<header class="main-header">
    <div class="header-left">
        <a href="{% url 'home' %}" class="logo-link">
            <img src="{% static 'imgs/logo-dual-fons-blau.png' %}" alt="Audiovook Dual" class="logo" />
            <div class="logo-text-container">
                <span class="logo-text">Dual</span>
                <span class="logo-subtitle">DUAL: Double Usage of Active Languages</span>
            </div>
        </a>
    </div>
    <nav class="header-right">
        <a href="{% url 'products:catalog' %}" data-translate-key="header.catalog">CatÃ leg</a>
        <a href="{% url 'products:product_list' %}" data-translate-key="header.products">Productes</a>
        {% if user.is_authenticated %}
            <div class="user-menu">
                <a href="#" class="user-menu-trigger">{% if user.first_name %}{{ user.first_name }}{% else %}{{ user.username }}{% endif %}</a>
                <div class="user-menu-dropdown">
                    <a href="{% url 'accounts:profile' %}" data-translate-key="header.profile">Perfil</a>
                    <a href="{% url 'accounts:library' %}" data-translate-key="header.my_library">La meva llibreria</a>
                    {% if user.is_staff %}
                        <a href="{% url 'products:product_create' %}" data-translate-key="header.add_product">Afegir producte</a>
                        <a href="{% url 'products:title_create' %}" data-translate-key="header.add_title">Afegir tÃ­tol</a>
                    {% endif %}
                    <a href="{% url 'logout' %}" data-translate-key="header.logout">Tanca sessiÃ³</a>
                </div>
            </div>
        {% else %}
            <a href="{% url 'login' %}" data-translate-key="header.login">Inicia sessiÃ³</a>
            <a href="{% url 'signup' %}" class="button button--small" data-translate-key="header.signup">Registra't</a>
        {% endif %}
        <div class="rightBtns">
            <button id="themeBtn">â˜€ï¸ <span data-translate-key="header.theme.light">Clar</span></button>
            <button id="infoBtn">â“ <span data-translate-key="header.help">Ajuda</span></button>
        </div>

        <div class="language-switcher">
            <select id="language-select">
                <option value="ca">CatalÃ </option>
                <option value="en">English</option>
                <option value="es">EspaÃ±ol</option>
                <option value="fr">FranÃ§ais</option>
                <option value="it">Italiano</option>
                <option value="pt">PortuguÃªs</option>
            </select>
        </div>
    </nav>
</header>

<main>
    {% if messages %}
        <div class="messages">
            {% for message in messages %}
                <div class="message message--{{ message.tags }}">{{ message }}</div>
            {% endfor %}
        </div>
    {% endif %}
    {% block content %}{% endblock %}
</main>

<footer class="footer">
    <div class="footer__content">
        <p>Â© Audiovook Dual. <span data-translate-key="footer.tagline">ComprensiÃ³ i escolta de llengÃ¼es a travÃ©s de narracions.</span></p>
    </div>
</footer>

<!-- Modal ajuda -->
<div id="infoModal">
  <div id="infoContent">

  <p data-translate-key="help_modal.intro">
    Selecciona una llengua principal i una secundÃ ria, ajusta la velocitat i gaudeix de la histÃ²ria. Pots alternar lâ€™ordre de les llengÃ¼es o escoltar nomÃ©s una versiÃ³.
  </p>

  <hr style="margin:1em 0;border:none;border-top:1px solid var(--accent,#f7836a);">

  <h3 data-translate-key="help_modal.title">ğŸŸ¢ Consells per gaudir i aprendre</h3>

  <ul style="line-height:1.6;">
    <li><b data-translate-key="help_modal.tip1_title">ğŸµ Escolta com si fos mÃºsica:</b><br>
    <span data-translate-key="help_modal.tip1_text">No cal entendre cada paraula ni traduir mentalment. Deixaâ€™t portar pel ritme, la melodia i les pauses de la veu. Repetint escoltes, el significat apareixerÃ  de manera intuÃ¯tiva.</span></li>

    <li><b data-translate-key="help_modal.tip2_title">ğŸ” Juga amb lâ€™ordre de les llengÃ¼es:</b><br>
    <span data-translate-key="help_modal.tip2_text">Pots comenÃ§ar escoltant primer la teva llengua i desprÃ©s la nova, desprÃ©s al contrari, i finalment nomÃ©s la nova. Cada ordre activa parts diferents del cervell i reforÃ§a la comprensiÃ³.</span></li>

    <li><b data-translate-key="help_modal.tip3_title">ğŸ—£ï¸ Llegeix i escolta:</b><br>
    <span data-translate-key="help_modal.tip3_text">Aprofita que veus el text per llegir-lo alhora que lâ€™escoltes. Compara la pronunciaciÃ³ i el ritme de la veu amb la teva lectura. Escriu o repeteix els fragments que mÃ©s tâ€™agradin: Ã©s una manera excelÂ·lent de fixar vocabulari i estructura.</span></li>

    <li><b data-translate-key="help_modal.tip4_title">âš™ï¸ Ajusta la velocitat:</b><br>
    <span data-translate-key="help_modal.tip4_text">Si et costa seguir, redueix la velocitat fins que reconeguis paraules i patrons. Quan et sentis mÃ©s segur, accelera fins al ritme natural de la parla.</span></li>

    <li><b data-translate-key="help_modal.tip5_title">ğŸ§ Escolta amb auriculars:</b><br>
    <span data-translate-key="help_modal.tip5_text">Et permetrÃ  captar millor la pronunciaciÃ³, la musicalitat i els detalls de la veu. Si pots, utilitza uns auriculars tancats que aÃ¯llin el soroll exterior.</span></li>

    <li><b data-translate-key="help_modal.tip6_title">ğŸ‘ï¸ Imagina el relat:</b><br>
    <span data-translate-key="help_modal.tip6_text">Tanca els ulls i visualitza el que passa. Imaginar reforÃ§a la memÃ²ria i et connecta emocionalment amb el llenguatge.</span></li>

    <li><b data-translate-key="help_modal.tip7_title">ğŸ“– Repassa el vocabulari:</b><br>
    <span data-translate-key="help_modal.tip7_text">DesprÃ©s dâ€™escoltar, intenta recordar paraules o frases noves. No cal apuntar-ho tot: tria les que tâ€™hagin cridat mÃ©s lâ€™atenciÃ³.</span></li>

    <li><b data-translate-key="help_modal.tip8_title">â³ Torna-hi mÃ©s endavant:</b><br>
    <span data-translate-key="help_modal.tip8_text">Cada escolta tâ€™aporta coses noves i consolida lâ€™aprenentatge sin pressa. Lâ€™aprenentatge auditiu millora quan hi ha repeticions espaiades en el temps.</span></li>

    <li><b data-translate-key="help_modal.tip9_title">ğŸŒ Gaudeix de la diversitat:</b><br>
    <span data-translate-key="help_modal.tip9_text">Cada histÃ²ria i cada veu provenen dâ€™una cultura diferent. Deixaâ€™t sorprendre per les expressions, els accents i les formes de dir les coses.</span></li>
  </ul>

  <p><b data-translate-key="help_modal.remember_title">Recorda:</b> <span data-translate-key="help_modal.remember_text">aprendre una llengua Ã©s una experiÃ¨ncia auditiva i emocional. Amb Audiovook Dual, pots aprendre escoltant histÃ²ries, sense pressiÃ³ i amb plaer.</span></p>


    <button id="closeModal" data-translate-key="help_modal.close">Tanca</button>
  </div>
</div>
</body>
</html>
